<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Industry Directory 2020-2023</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lexend:wght@100;200;300;400;500;600;700;800;900&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        :root {
            --primary-gradient: linear-gradient(135deg, #F5F0E8 0%, #E6DACE 100%);
            --glass-bg: rgba(255, 255, 255, 0.4);
            --glass-border: rgba(222, 205, 189, 0.5);
            --text-primary: #4A423B;
            --text-secondary: #6B6259;
            --text-tertiary: #8A817C;
            --shadow: 0 8px 32px 0 rgba(138, 129, 124, 0.3);
            --backdrop-blur: blur(15px);
            --accent-color: #8d6e63;
        }
        body {
            font-family: 'Lexend', sans-serif;
            font-weight: 300;
            min-height: 100vh;
            background: var(--primary-gradient);
            color: var(--text-primary);
            overflow-x: hidden;
            position: relative;
        }
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 50%, rgba(205, 187, 167, 0.3), transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(222, 205, 189, 0.3), transparent 50%),
                radial-gradient(circle at 40% 20%, rgba(255, 255, 255, 0.3), transparent 50%);
            z-index: -1;
            animation: gradientShift 20s ease infinite;
        }
        @keyframes gradientShift {
            0%, 100% { transform: rotate(0deg) scale(1); }
            50% { transform: rotate(180deg) scale(1.1); }
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 2rem;
        }
        header {
            text-align: center;
            margin-bottom: 3rem;
            animation: fadeInDown 0.8s ease;
        }
        h1 {
            font-size: 3.5rem;
            font-weight: 100;
            margin-bottom: 0.5rem;
            letter-spacing: 0.05em;
            text-shadow: 0 0 40px rgba(74, 66, 59, 0.2);
        }
        .subtitle {
            font-size: 1.2rem;
            font-weight: 200;
            color: var(--text-secondary);
            letter-spacing: 0.1em;
        }
        .controls {
            display: flex;
            gap: 1.5rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            align-items: center;
            animation: fadeIn 1s ease 0.2s both;
        }
        .search-container {
            flex: 1;
            min-width: 300px;
            position: relative;
        }
        .search-input {
            width: 100%;
            padding: 1rem 1.5rem 1rem 3rem;
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            color: var(--text-primary);
            font-family: 'Lexend', sans-serif;
            font-weight: 300;
            font-size: 1rem;
            backdrop-filter: var(--backdrop-blur);
            transition: all 0.3s ease;
        }
        .search-input::placeholder {
            color: var(--text-tertiary);
        }
        .search-input:focus {
            outline: none;
            background: rgba(255, 255, 255, 0.5);
            border-color: rgba(74, 66, 59, 0.4);
            box-shadow: 0 0 30px rgba(74, 66, 59, 0.1);
        }
        .search-icon {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-tertiary);
        }
        .tabs {
            display: flex;
            gap: 0.5rem;
            background: var(--glass-bg);
            backdrop-filter: var(--backdrop-blur);
            padding: 0.5rem;
            border-radius: 20px;
            border: 1px solid var(--glass-border);
        }
        .tab {
            padding: 0.8rem 1.5rem;
            background: transparent;
            border: none;
            border-radius: 15px;
            color: var(--text-secondary);
            font-family: 'Lexend', sans-serif;
            font-weight: 400;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }
        .tab::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(74, 66, 59, 0.05);
            transform: translateX(-100%);
            transition: transform 0.3s ease;
        }
        .tab:hover::before {
            transform: translateX(0);
        }
        .tab.active {
            background: rgba(255, 255, 255, 0.6);
            color: var(--text-primary);
            font-weight: 500;
            box-shadow: 0 4px 15px rgba(74, 66, 59, 0.1);
        }
        .ai-button {
            padding: 0.8rem 1.5rem;
            background: var(--glass-bg);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            color: var(--text-secondary);
            font-family: 'Lexend', sans-serif;
            font-weight: 400;
            font-size: 0.95rem;
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: var(--backdrop-blur);
        }
        .ai-button:hover {
            background: rgba(255, 255, 255, 0.6);
            color: var(--text-primary);
            box-shadow: 0 4px 15px rgba(74, 66, 59, 0.1);
        }
        .stats-bar {
            display: flex;
            gap: 2rem;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            animation: fadeIn 1s ease 0.4s both;
        }
        .stat-card {
            flex: 1;
            min-width: 200px;
            background: var(--glass-bg);
            backdrop-filter: var(--backdrop-blur);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 1.2rem;
            text-align: center;
            transition: all 0.3s ease;
        }
        .stat-card:hover {
            transform: translateY(-5px);
            background: rgba(255, 255, 255, 0.5);
            box-shadow: 0 10px 40px rgba(74, 66, 59, 0.1);
        }
        .stat-number {
            font-size: 2rem;
            font-weight: 600;
            margin-bottom: 0.3rem;
        }
        .stat-label {
            font-size: 0.9rem;
            font-weight: 200;
            color: var(--text-secondary);
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }
        .table-container {
            background: var(--glass-bg);
            backdrop-filter: var(--backdrop-blur);
            border: 1px solid var(--glass-border);
            border-radius: 25px;
            padding: 2rem;
            box-shadow: var(--shadow);
            overflow: hidden;
            animation: fadeInUp 0.8s ease 0.6s both;
        }
        .table-wrapper {
            max-height: 500px;
            overflow: auto;
            margin: -1rem;
            padding: 1rem;
        }
        table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0;
        }
        thead {
            position: sticky;
            top: -1rem;
            z-index: 10;
        }
        thead tr {
            background: rgba(230, 218, 206, 0.7);
            backdrop-filter: var(--backdrop-blur);
        }
        th {
            padding: 1.2rem 1rem;
            text-align: left;
            font-weight: 500;
            font-size: 0.85rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--text-secondary);
            cursor: pointer;
            transition: color 0.3s ease;
        }
        th:hover {
            color: var(--text-primary);
        }
        tbody tr {
            transition: all 0.2s ease-out;
            border-bottom: 1px solid rgba(138, 129, 124, 0.15);
        }
        tbody tr:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.01);
        }
        tbody tr:last-child {
            border-bottom: none;
        }
        td {
            padding: 1.2rem 1rem;
            font-weight: 300;
            font-size: 0.95rem;
            color: var(--text-primary);
            vertical-align: middle;
        }
        .name-cell {
            font-weight: 500;
            font-size: 1rem;
        }
        .year-badge {
            display: inline-block;
            padding: 0.3rem 0.8rem;
            background: rgba(74, 66, 59, 0.1);
            border-radius: 10px;
            font-weight: 400;
            font-size: 0.85rem;
        }
        .link-cell a, .summarize-btn {
            color: var(--text-secondary);
            text-decoration: none;
            padding: 0.5rem 1rem;
            background: rgba(74, 66, 59, 0.08);
            border-radius: 12px;
            display: inline-block;
            transition: all 0.3s ease;
            font-weight: 400;
            border: none;
            cursor: pointer;
            font-family: 'Lexend', sans-serif;
            font-size: 0.9rem;
        }
        .link-cell a:hover, .summarize-btn:hover {
            background: rgba(74, 66, 59, 0.15);
            color: var(--text-primary);
            transform: translateX(5px);
        }
        .instagram-cell {
            font-weight: 400;
            color: var(--text-secondary);
        }
        .hidden { display: none !important; }
        .no-results {
            text-align: center;
            padding: 3rem;
            font-weight: 200;
            font-size: 1.2rem;
            color: var(--text-tertiary);
        }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes fadeInDown { from { opacity: 0; transform: translateY(-30px); } to { opacity: 1; transform: translateY(0); } }
        
        .floating-orb {
            position: fixed;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(222, 205, 189, 0.4), transparent 70%);
            filter: blur(50px);
            pointer-events: none;
            animation: float 20s infinite ease-in-out;
        }
        .orb-1 { width: 300px; height: 300px; top: 10%; left: -150px; animation-delay: 0s; }
        .orb-2 { width: 200px; height: 200px; bottom: 10%; right: -100px; animation-delay: 7s; }
        .orb-3 { width: 250px; height: 250px; top: 50%; right: 10%; animation-delay: 14s; }
        
        @keyframes float {
            0%, 100% { transform: translate(0, 0) scale(1); }
            33% { transform: translate(100px, -50px) scale(1.1); }
            66% { transform: translate(-50px, 100px) scale(0.9); }
        }

        /* Modal Styles */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(5px);
            z-index: 1000;
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.3s ease;
        }
        .modal-overlay.visible {
            opacity: 1;
            pointer-events: all;
        }
        .modal-content {
            background: var(--glass-bg);
            backdrop-filter: var(--backdrop-blur);
            border: 1px solid var(--glass-border);
            border-radius: 20px;
            padding: 2rem;
            width: 90%;
            max-width: 600px;
            box-shadow: var(--shadow);
            transform: scale(0.95);
            transition: transform 0.3s ease;
        }
        .modal-overlay.visible .modal-content {
            transform: scale(1);
        }
        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 1.5rem;
            border-bottom: 1px solid var(--glass-border);
            padding-bottom: 1rem;
        }
        .modal-title {
            font-size: 1.5rem;
            font-weight: 400;
        }
        .modal-close {
            background: none;
            border: none;
            font-size: 1.8rem;
            cursor: pointer;
            color: var(--text-secondary);
            transition: color 0.3s ease;
        }
        .modal-close:hover {
            color: var(--text-primary);
        }
        .modal-body {
            font-weight: 300;
            line-height: 1.6;
        }
        .modal-body ul {
            list-style-position: inside;
            padding-left: 0.5rem;
        }
        .modal-body li {
            margin-bottom: 0.75rem;
        }
        .loader {
            width: 48px;
            height: 48px;
            border: 5px solid var(--text-tertiary);
            border-bottom-color: var(--text-primary);
            border-radius: 50%;
            display: block;
            margin: 2rem auto;
            box-sizing: border-box;
            animation: rotation 1s linear infinite;
        }
        @keyframes rotation {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @media (max-width: 768px) {
            body {
                -webkit-text-size-adjust: 100%;
            }
            .container {
                padding: 2rem 1rem;
            }
            h1 { font-size: 2.2rem; }
            .subtitle { font-size: 1.1rem; }
            .controls, .stats-bar {
                flex-direction: column;
                gap: 1.25rem;
            }
            .tabs, .ai-button {
                align-self: center;
            }
            .tab {
                padding: 0.7rem 1.1rem;
                font-size: 0.9rem;
            }
            .table-container { padding: 1.5rem 0.8rem; }
            th, td {
                padding: 1rem 0.6rem;
                font-size: 0.85rem;
            }
            .stat-card { padding: 1rem; }
            .stat-number { font-size: 1.8rem; }
        }
    </style>
</head>
<body>
    <div class="floating-orb orb-1"></div>
    <div class="floating-orb orb-2"></div>
    <div class="floating-orb orb-3"></div>

    <div class="container">
        <header>
            <h1>Industry Directory</h1>
            <p class="subtitle">London's Emerging Brands 2020-2023</p>
        </header>

        <div class="controls">
            <div class="search-container">
                <span class="search-icon">
                    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" viewBox="0 0 16 16">
                        <path d="M11.742 10.344a6.5 6.5 0 1 0-1.397 1.398h-.001c.03.04.062.078.098.115l3.85 3.85a1 1 0 0 0 1.415-1.414l-3.85-3.85a1.007 1.007 0 0 0-.115-.1zM12 6.5a5.5 5.5 0 1 1-11 0 5.5 5.5 0 0 1 11 0z"/>
                    </svg>
                </span>
                <input type="text" class="search-input" id="searchInput" placeholder="Search by name, description, or year...">
            </div>
            <div class="tabs">
                <button class="tab active" data-category="all">All</button>
                <button class="tab" data-category="fashion">Fashion</button>
                <button class="tab" data-category="hospitality">Hospitality</button>
                <button class="tab" data-category="product">Products</button>
            </div>
             <button class="ai-button" id="analyzeTrendsBtn">✨ Analyze Trends</button>
        </div>

        <div class="stats-bar">
            <!-- ... stats cards ... -->
             <div class="stat-card">
                <div class="stat-number" id="totalCount">0</div>
                <div class="stat-label">Total Brands</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="fashionCount">0</div>
                <div class="stat-label">Fashion</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="hospitalityCount">0</div>
                <div class="stat-label">Hospitality</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="productCount">0</div>
                <div class="stat-label">Products</div>
            </div>
        </div>

        <div class="table-container">
            <div class="table-wrapper">
                <table id="dataTable">
                    <thead>
                        <tr>
                            <th data-sort="name">Name ↕</th>
                            <th data-sort="description">Description</th>
                            <th data-sort="year">Year ↕</th>
                            <th>Website</th>
                            <th>Instagram</th>
                            <th data-sort="category">Industry ↕</th>
                            <th>AI Summary</th>
                        </tr>
                    </thead>
                    <tbody id="tableBody"></tbody>
                </table>
                <div class="no-results hidden" id="noResults">No results found. Try adjusting your search.</div>
            </div>
        </div>
    </div>

    <!-- Modal Structure -->
    <div class="modal-overlay" id="aiModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle">AI Analysis</h2>
                <button class="modal-close" id="modalCloseBtn">&times;</button>
            </div>
            <div class="modal-body" id="modalBody">
                <!-- AI content will be injected here -->
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Data
            const fashionData = [
                { name: "LỰU ĐẠN (Lu'u Dan)", description: "Menswear label blending Asian heritage, streetwear and luxury tailoring.", year: 2021, website: "https://luu-dan.com/", instagram: "@luudan_official (~82K)" },
                { name: "Sinéad O'Dwyer", description: "Womenswear label focusing on inclusive sizing and crafted garments.", year: 2021, website: "https://sineadodwyer.com/", instagram: "@sjodwyer (~59.7k)" },
                { name: "Labrum London", description: "Menswear label mixing West African heritage & British tailoring.", year: 2020, website: "https://labrumlondon.com/", instagram: "@labrumlondon (~57.4K)" },
                { name: "Ahluwalia", description: "Fashion brand merging Indian & Nigerian heritage with sustainable fabrics.", year: 2020, website: "https://ahluwalia.world/", instagram: "@ahluwalia (~79.1K)" },
                { name: "Hegarty", description: "London-based sustainable outerwear for women, men, and unisex", year: 2021, website: "https://www.hegartylondon.com/", instagram: "@hegartylondon (~3.2K)" },
                { name: "Aligne", description: "Sustainable women's wardrobe brand from East London", year: 2020, website: "https://aligne.co/", instagram: "@aligne (~174K)" },
                { name: "Cou Cou Intimates", description: "Body-positive lingerie and underwear made with 100% organic cotton", year: 2021, website: "https://coucouintimates.com/", instagram: "@coucouintimates (~186k)" },
                { name: "Hey Savi", description: "AI-driven fashion search engine (\"search and shop by image/text\")", year: 2023, website: "https://heysavi.com/", instagram: "@heysaviofficial (~455)" },
                { name: "7879", description: "Contemporary jewellery house (designing modern pieces)", year: 2021, website: "https://7879.co/", instagram: "@7879_london (~27.6k)" },
                { name: "The Edit LDN", description: "Online marketplace for limited-edition sneakers and streetwear", year: 2020, website: "https://www.theeditldn.com/", instagram: "@theeditldn (~55.6k)" },
                { name: "Saul Nash", description: "Sportswear-meets-dance label redefining menswear.", year: 2021, website: "https://saulnash.com/", instagram: "@saul.nash (~34.8K)" },
                { name: "Stefan Cooke", description: "Avant-garde menswear with modern tailoring.", year: 2020, website: "https://www.stefancooke.co.uk/", instagram: "@stefan_cooke (~86.4k)" },
                { name: "Masha Popova", description: "Ukrainian-born London designer with Y2K-inspired looks.", year: 2021, website: "https://masha-popova.com/", instagram: "@mashapopovap (~73.2k)" },
                { name: "Feben", description: "London-based womenswear with bold prints & sculptural looks.", year: 2020, website: "https://feben.co/", instagram: "@feben.x (~27.3k)" },
                { name: "Roker Atelier", description: "Footwear label blending punk with luxury.", year: 2020, website: "https://www.rokeratelier.com/", instagram: "@rokeratelier (~10.2k)" }
            ];
            const hospitalityData = [
                { name: "Dauns", description: "Vegan Scandinavian-inspired café and delicatessen", year: 2021, website: "https://dauns.co.uk/", instagram: "@dauns_scandifood (~7K)" },
                { name: "Café Petiole", description: "Independent (mostly) vegan café in Somerset House serving seasonal fare", year: 2023, website: "https://www.cafepetiole.co.uk/", instagram: "@cafepetiole (~5.3k)" },
                { name: "The Dialogue Cafe", description: "Neighborhood eatery on Upper Clapton Road in London", year: null, website: "", instagram: "@the_dialogue_cafe (~1K)" },
                { name: "The Lost Poet", description: "Boutique 4-room townhouse hotel in Notting Hill", year: 2021, website: "https://www.thelostpoet.co.uk/", instagram: "@thelostpoetportobello (~11.9K)" },
                { name: "Bonsai Plant Kitchen", description: "South-east Asian vegan restaurant", year: 2021, website: "https://www.bonsaiplantkitchen.co.uk/", instagram: "@bonsaiplantkitchen (~10.5K)" },
                { name: "Bean's Café", description: "Plant-based community café near Hackney Downs", year: 2020, website: "", instagram: "@beanandfriendsltd (~5.1K)" },
                { name: "Lisboeta", description: "Portuguese restaurant in Fitzrovia.", year: 2022, website: "https://www.lisboeta.co.uk/", instagram: "@lisboeta.london (~48.3k)" },
                { name: "Evelyn's Table", description: "Soho fine dining counter.", year: 2020, website: "", instagram: "@evelynstable (~33k)" },
                { name: "Princess Royal", description: "Victorian pub with 4 boutique bedrooms in Notting Hill", year: 2021, website: "https://www.cubitthouse.co.uk/the-princess-royal-boutique-hotel-notting-hill/", instagram: "@princessroyalnottinghill (~22.1k)" },
                { name: "GECKO Coffeehouse", description: "A coffee and plant shop in Camden", year: 2023, website: "https://geckocoffee.house/", instagram: "@geckocoffeehouse (~9k)" },
                { name: "Inhabit", description: "A wellness-focused boutique hotel", year: 2021, website: "https://www.inhabithotels.com/", instagram: "@inhabit_hotels (~15.2K)" },
                { name: "Moko", description: "A bustling Italian café and deli", year: 2022, website: "https://mokorestaurant.com/", instagram: "@moko.hinckley (~3.3k)" },
                { name: "Laxeiro", description: "A Galician restaurant and tapas bar. (Relaunched 2022).", year: 2022, website: "https://laxeiro.co.uk/", instagram: "@laxiero_restaurant (~2.6k)" },
                { name: "Queen of Cups", description: "A critically acclaimed, female-led restaurant", year: 2021, website: "https://queenofcups.co.uk/", instagram: "@glastoqueenofcups (~4.6k)" }
            ];
            const productData = [
                { name: "Fara Homidi Beauty", description: "Make-up brand", year: 2023, website: "https://farahomidi.com/", instagram: "@farahomidibeauty (~29.8K)" },
                { name: "RATA", description: "Luxury bead-art jewellery brand", year: 2023, website: "https://www.cafepetiole.co.uk/", instagram: "@ratalove.in (~5.5k)" },
                { name: "Some Grub", description: "Dog treats made from insect protein.", year: 2021, website: "https://somegrub.co.uk/", instagram: "@somegrub (~1.6K)" },
                { name: "Our Remedy", description: "Natural wellness brand (CBD remedies for sleep, PMS, stress)", year: 2020, website: "https://ourremedy.co.uk/", instagram: "@itsourremedy (~9.9K)" },
                { name: "Carisips", description: "Non-alcoholic ginger/turmeric beer alternative", year: 2020, website: "https://www.carisips.com/", instagram: "@carisips (~1.1K)" },
                { name: "Workshop Coffee", description: "Specialty coffee roaster & goods.", year: 2020, website: "https://workshopcoffee.com/", instagram: "@workshopcoffee (~52.8K)" },
                { name: "Charlene Mullen", description: "Embroidered textiles & homeware.", year: 2020, website: "https://www.charlenemullen.com/", instagram: "@charlene_mullen (~2.5k)" },
                { name: "House of Quinn", description: "Textile-based art & home goods.", year: 2020, website: "https://houseofquinn.co.uk/", instagram: "@houseofquinn (~23.7k)" },
                { name: "Grace & Thorn", description: "Urban plant & lifestyle store.", year: 2020, website: "https://graceandthorn.com/", instagram: "@graceandthorn (~90.8k)" },
                { name: "Molesworth & Bird", description: "Seaweed press prints & gifts.", year: 2020, website: "https://www.molesworthandbird.com/", instagram: "@molesworthandbird (~24.2k)" },
                { name: "Aerende", description: "Home goods made by people facing social challenges.", year: 2020, website: "https://www.aerende.co.uk/", instagram: "@aerendeshop (~12.4K)" },
                { name: "Aeyre", description: "Modern homeware brand.", year: 2021, website: "https://reliquiacollective.com/collections/aeyre", instagram: "@aeyre_home (~8k)" },
                { name: "Fern Fans", description: "Artisan hand fans.", year: 2020, website: "", instagram: "@fernfans_ (~3k)" },
                { name: "Rosie Dalia", description: "Homeware & kids' clothing celebrating Indian craft.", year: 2021, website: "https://www.rosiedalia.com/", instagram: "@rosiedaliahome (~6.8k)" }
            ];

            const allData = [
                ...fashionData.map(item => ({ ...item, category: 'fashion' })),
                ...hospitalityData.map(item => ({ ...item, category: 'hospitality' })),
                ...productData.map(item => ({ ...item, category: 'product' }))
            ];

            let currentCategory = 'all';
            let currentSort = { field: 'name', ascending: true };
            let filteredData = [...allData];

            const tbody = document.getElementById('tableBody');
            const noResults = document.getElementById('noResults');
            const modal = document.getElementById('aiModal');
            const modalTitle = document.getElementById('modalTitle');
            const modalBody = document.getElementById('modalBody');

            // --- Gemini API Integration ---
            const API_KEY = ""; // Kept empty as per instructions
            const API_URL = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${API_KEY}`;
            
            async function callGeminiAPI(systemPrompt, userQuery, retries = 3, delay = 1000) {
                const payload = {
                    contents: [{ parts: [{ text: userQuery }] }],
                    systemInstruction: { parts: [{ text: systemPrompt }] },
                };

                for (let i = 0; i < retries; i++) {
                    try {
                        const response = await fetch(API_URL, {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify(payload)
                        });

                        if (!response.ok) {
                           throw new Error(`API Error: ${response.status}`);
                        }

                        const result = await response.json();
                        const candidate = result.candidates?.[0];
                        if (candidate && candidate.content?.parts?.[0]?.text) {
                            return candidate.content.parts[0].text;
                        } else {
                            throw new Error("Invalid response structure from API.");
                        }
                    } catch (error) {
                        if (i === retries - 1) {
                            console.error("API call failed after multiple retries:", error);
                            return "Sorry, the AI analysis failed. Please try again later.";
                        }
                        await new Promise(res => setTimeout(res, delay * Math.pow(2, i)));
                    }
                }
            }
            
            function showModal(title, content) {
                modalTitle.textContent = title;
                modalBody.innerHTML = content;
                modal.classList.add('visible');
            }

            function hideModal() {
                modal.classList.remove('visible');
            }

            async function handleSummarizeClick(item) {
                showModal(`Summary for ${item.name}`, '<div class="loader"></div>');
                const systemPrompt = "You are a business analyst. Based on the provided data (Name, Description, Year, Industry), generate a concise, one-sentence summary of the brand's market position and target audience. Be insightful and specific.";
                const userQuery = `Analyze the following brand: Name: ${item.name}, Description: ${item.description}, Year Founded: ${item.year}, Industry: ${item.category}.`;
                
                const summary = await callGeminiAPI(systemPrompt, userQuery);
                modalBody.innerHTML = summary;
            }

            async function handleAnalyzeTrendsClick() {
                if (filteredData.length === 0) {
                    showModal("Trend Analysis", "No data available to analyze. Please broaden your search or select a different category.");
                    return;
                }
                const categoryName = currentCategory.charAt(0).toUpperCase() + currentCategory.slice(1);
                showModal(`${categoryName} Industry Trends`, '<div class="loader"></div>');
                
                const systemPrompt = "You are a market trend analyst. Based on the following list of brands from a specific industry, identify 2-3 key emerging trends. Present these trends as a bulleted list in HTML format (using <ul> and <li>), with each point being a concise sentence. Focus on themes like sustainability, niche markets, cultural fusion, and technology.";
                const userQuery = `Analyze these brands: ${JSON.stringify(filteredData.map(({name, description, year}) => ({name, description, year})))}`;

                const trends = await callGeminiAPI(systemPrompt, userQuery);
                modalBody.innerHTML = trends;
            }

            // --- Core App Logic ---
            function renderTable(data) {
                if (data.length === 0) {
                    tbody.innerHTML = '';
                    noResults.classList.remove('hidden');
                    return;
                }

                noResults.classList.add('hidden');
                const rowsHtml = data.map((item, index) => `
                    <tr>
                        <td class="name-cell">${item.name}</td>
                        <td>${item.description}</td>
                        <td>${item.year ? `<span class="year-badge">${item.year}</span>` : '—'}</td>
                        <td class="link-cell">${item.website ? `<a href="${item.website}" target="_blank" rel="noopener noreferrer">Visit →</a>` : '—'}</td>
                        <td class="instagram-cell">${item.instagram || '—'}</td>
                        <td>${item.category.charAt(0).toUpperCase() + item.category.slice(1)}</td>
                        <td><button class="summarize-btn" data-index="${index}">✨ Summarize</button></td>
                    </tr>
                `).join('');
                tbody.innerHTML = rowsHtml;
                
                // Add event listeners after rows are rendered
                document.querySelectorAll('.summarize-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const item = filteredData[parseInt(e.currentTarget.dataset.index)];
                        handleSummarizeClick(item);
                    });
                });
            }

            function updateStats() {
                document.getElementById('totalCount').textContent = allData.length;
                document.getElementById('fashionCount').textContent = fashionData.length;
                document.getElementById('hospitalityCount').textContent = hospitalityData.length;
                document.getElementById('productCount').textContent = productData.length;
            }
            
            function filterAndSort() {
                const searchTerm = document.getElementById('searchInput').value.toLowerCase();
                let tempData = [...allData];

                if (currentCategory !== 'all') {
                    tempData = tempData.filter(item => item.category === currentCategory);
                }

                if (searchTerm) {
                    tempData = tempData.filter(item =>
                        (item.name && item.name.toLowerCase().includes(searchTerm)) ||
                        (item.description && item.description.toLowerCase().includes(searchTerm)) ||
                        (item.year && item.year.toString().includes(searchTerm))
                    );
                }
                
                if (currentSort.field) {
                    tempData.sort((a, b) => {
                        const valA = a[currentSort.field] === null ? '' : String(a[currentSort.field]);
                        const valB = b[currentSort.field] === null ? '' : String(b[currentSort.field]);
                        
                        let comparison = valA.localeCompare(valB, undefined, {numeric: true});
                        return currentSort.ascending ? comparison : -comparison;
                    });
                }
                
                filteredData = tempData;
                renderTable(filteredData);
            }

            function setupEventListeners() {
                document.getElementById('searchInput').addEventListener('input', filterAndSort);
                document.getElementById('analyzeTrendsBtn').addEventListener('click', handleAnalyzeTrendsClick);
                document.getElementById('modalCloseBtn').addEventListener('click', hideModal);
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) hideModal();
                });

                document.querySelectorAll('.tab').forEach(tab => {
                    tab.addEventListener('click', (e) => {
                        document.querySelector('.tab.active').classList.remove('active');
                        e.currentTarget.classList.add('active');
                        currentCategory = e.currentTarget.dataset.category;
                        filterAndSort();
                    });
                });

                document.querySelectorAll('th[data-sort]').forEach(th => {
                    th.addEventListener('click', () => {
                        const field = th.dataset.sort;
                        if (currentSort.field === field) {
                            currentSort.ascending = !currentSort.ascending;
                        } else {
                            currentSort.field = field;
                            currentSort.ascending = true;
                        }
                        filterAndSort();
                    });
                });
            }

            updateStats();
            setupEventListeners();
            filterAndSort();
        });
    </script>
</body>
</html>

